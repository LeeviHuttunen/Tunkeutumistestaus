# Täysin laillinen sertifikaatti

## x) Lue/katso ja tiivistä

## OWASP 2021: OWASP Top 10:2021
- Viallinen pääsynhallinta on riski, jota voidaan käyttää hyödyksi hakkeroinnissa.
- Esimerkiksi url:llän muokkaaminen, laiskasti tehty API-järjestelmä (esim. rajattomat API-pyynnöt) ovat hyviä hyökkäyskohteita
- Suojaamiskeinoja ovat deny by default, API-pyyntöjen rajoittaminen, käyttäjänvarmennus.

## Insecure direct object references (IDOR)
- Pääsynhallinnan haavoittuvuus
- Esimerkiksi jos käyttäjän numero on näkyvillä (esim. joku.com/customer_account?customer_number=132355) käyttäjänumeroa muuttaessa voi päästä toiselle käyttäjälle.

## Path traversal
- Path traversal haavoittuvuudessa voidaan mennä määriteltyä polkua pitkin tiedostoihin.
- Jos nettisivun url:ssä lukee, että kuva on ladattu suoraan tiedostoista, voidaan muihinkin kansioihin ja tiedostoihin päästä tavalla:(https://jokusivu.com/loadImage?filename=../../../etc/passwd)

## Cross-site scripting (XSS)
- Hyökkääjä voi laittaa haitallista Javascript-koodia hyökättävän selaimeen.
- Hyökkäyksellä voidaan kaapata käyttäjän tietoa ja saada käyttäjän sovelluksen hallinta itselleen.


## a) Totally Legit Sertificate. Asenna OWASP ZAP, generoi CA-sertifikaatti ja asenna se selaimeesi. Laita ZAP proxyksi selaimeesi. Laita ZAP sieppaamaan myös kuvat, niitä tarvitaan tämän kerran kotitehtävissä. Osoita, että hakupyynnöt ilmestyvät ZAP:n käyttöliittymään. (Ei toimine localhost:lla ilman Foxyproxya)

- Ensimmäisenä asensin Zapin komennolla `'sudo apt-get install zaproxy`
- Sitten pitäisi luoda sertifikaatti. Kohdasta tools-> options-> network-> server certificates löytyi sertifikaatti

  <img width="768" height="591" alt="image" src="https://github.com/user-attachments/assets/d347e8e1-40d0-4f29-a423-f004b5f9c766" />

- Tallensin sertifikaatin virtuaalikoneelleni. Seuraavaksi avasin Firefoxin, menin asetuksiin, josta kohdasta privacy and security laitoin hakusanaksi certificates. Kohdasta view certificates lisäsin luomani sertifikaatin sinne.

<img width="680" height="460" alt="image" src="https://github.com/user-attachments/assets/76d4ab99-8823-4e03-bad2-17724614c5a8" />

- Sitten asensin Zapin proxyksi Firefoxin asetuksista.

<img width="752" height="626" alt="image" src="https://github.com/user-attachments/assets/7f6a903b-b1f9-4222-a19d-b6cf521df0d9" />

Seuraavaksi avasin edellisissä tehtävissä käyttämäni Metalsploitable virtuaalikoneen. Ensiksi varmistin ettei Kali-Linux virtuaalikone ole verkossa ja että koneet ovat yhteydessä toisiinsa. Sitten pingasin Metalspoitablen ip-osoitteen.

<img width="1264" height="203" alt="image" src="https://github.com/user-attachments/assets/d9a9efdc-f009-4475-a93f-314e22799282" />

Firefoxissa ei näkynyt Metalspoitablen sivua, mutta Zappiin tuli hakupyyntöjä:

<img width="1151" height="255" alt="image" src="https://github.com/user-attachments/assets/ce9481de-295a-43ec-844c-52a51594608d" />

Sitten vielä laitoin Zapin sieppaamaan kuvat kohdasta: Options-> Display -> Klikkasin kohtaa Process images in HTTP requests/responses

<img width="743" height="566" alt="image" src="https://github.com/user-attachments/assets/9a643726-96e2-4346-8fd1-dabedfb05d4f" />

## b) Kettumaista. Asenna "FoxyProxy Standard" Firefox Addon, ja lisää ZAP proxyksi siihen. Käytä FoxyProxyn "Patterns" -toimintoa, niin että vain valitsemasi weppisivut ohjataan Proxyyn. (Läksyssä ohjataan varmaankin PortSwigger Labs ja localhost.)

- Ensiksi laitoin nat-verkon päälle, mutta proxy-yhteys ei antanut ottaa yhteyttä verkkoon. Jouduin laittamaan Proxyn hetkeksi pois päältä.

<img width="784" height="635" alt="image" src="https://github.com/user-attachments/assets/ab437ea2-8e8c-421a-bd5a-51c5f73ab1ab" />

Sitten menin Foxyproxyn asetuksiin Firefoxista -> add-ons and themes -> Extensions -> Foxyproxyn kohdalla Preferences

<img width="1245" height="519" alt="image" src="https://github.com/user-attachments/assets/b6a1c218-47b5-4ca0-8a5e-16179f9e1f6c" />

Sitten lisäsin vielä sinne Localhostin ja Portswigger.netin.

<img width="1240" height="568" alt="image" src="https://github.com/user-attachments/assets/973fb635-6b17-460f-b44b-d883d7708cbf" />










 ## Lähteet
 - https://csrc.nist.gov/glossary/term/Deny_by_Default Deny by default määritelmä
 - https://portswigger.net/web-security/access-control/idor IDOR
 - https://portswigger.net/web-security/file-path-traversal Path traversal
 - https://portswigger.net/web-security/cross-site-scripting XSS
