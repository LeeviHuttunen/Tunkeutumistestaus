# h5 Syyskuu2025!

## x) Lue/katso ja tiivistä. 

## - Karvinen 2022: Cracking Passwords with Hashcat

- Hashcat on ohjelma, joka voi murtaa salasanan hashista.

- Hashcatin pitää tietää, millä hash-tyypillä salasana on salattu. Sen voi selvittää komennolla `hashid -m`.

- Hashcat käyttää sanakirjastoa avukseen, josta koittaa arvata salasanan.

## - Karvinen 2023: Crack File Password With John

- John the ripper työkalu voi murtaa salasanoja useammasta eri formaatista: esim c-tehtävässä Zip.

- Käyttää myös hyväkseen sanakirjaa, kuten Hashcat.


## - € Santos et al 2017: Security Penetration Testing - The Art of Hacking Series LiveLessons: Lesson 6: Hacking User Credentials (8 videos, about 30 min)
- Jos hyökkääjä löytää/murtaa yhden salasanan, on todennäköistä, että käyttäjä käyttää samaa salasanaa useampaan paikkaan.
 ### Salasanojen murtaminen on yhä helpompaa. Syitä tähän ovat:
- Jatkuvasti tehokkaammat prosessorit -> Murtaa salasanan nopeammin
- Jatkuvasti kehittyvät sanalistat
- Videolla käytiin läpi myös John the ripperin ja Hashcatin käyttöä.
### Kuinka parantaa salasanojen turvallisuutta?
- 2-vaiheinen tunnistautuminen
- Ei samaa salasanaa joka paikkaan.
- Yrityksien verkkoon yms. Ei riitä enää nykyisin 8 kirjaimen salasanat, vaan salasanojen pitäisi olla sitäkin pidempiä.


## a) Asenna Hashcat ja testaa sen toiminta murtamalla esimerkkisalasana.

- Hashcat ja hashid olivat jo valmiiksi asennettu Kali virtuaalikoneelleni.
- Loin uuden hakemiston `mkdir hashed`, jonka jälkeen siirryin hakemistoon komennolla `cd hashed`
- Latasin Rockyou sanakirjaston komennoilla ` wget https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz`
- `tar xf rockyou.txt.tar.gz`
`rm rockyou.txt.tar.gz`

- Komennolla `hashid -m 6b1628b016dff46e6fa35684be6acc96` Hashcat koittaa arvata, mikä hash salasanalla on käytössä:

<img width="388" height="107" alt="image" src="https://github.com/user-attachments/assets/cf3d50be-fd41-479b-88f3-7344f2184395" />

Teron Cracking Passwords with Hashcat-sivun mukaan, vastaus on yleensä joku kolmesta ensimmäisestä.

- Koitan murtaa oman keksimän salasanan. Silmääni osui, että salasana "liverpool" oli rockyou listalla, joten koitetaan murtaa se Hashcatilla.

- Ensiksi komennolla `echo -n "liverpool" | md5sum` sain salasanaan md5sum hashin.

- Seuraavaksi koitin selvittää hashin tyypin komennolla `hashid -m` (ja hash perään)

<img width="384" height="169" alt="image" src="https://github.com/user-attachments/assets/82e8b193-6202-44a8-a5fc-bcb7d07a2654" />

- Näistä md5 olisi oikea. m on komennossa mode, joten komentoon pitää laittaa `-m 0`, koska md5 mode on 0.

- Seuraavaksi lähdin murtamaan salasanaa:

<img width="1197" height="704" alt="image" src="https://github.com/user-attachments/assets/116f0911-d1c2-4557-aa1b-7a17ae87634f" />

Kuvan aivan alalaidassa lukee status: Cracked, joten salasana murrettiin onnistuneesti.

- Komennolla `cat solved` löytyi sitten salasana:

<img width="348" height="64" alt="image" src="https://github.com/user-attachments/assets/604281ea-f834-440b-b764-1ebe3b73e42c" />


## c) Asenna John the Ripper ja testaa sen toiminta murtamalla jonkin esimerkkitiedoston salasana.

- Ensiksi latasin tarvittavat paketit Teron "Crack File Password With John"- sivulta:

<img width="1163" height="112" alt="image" src="https://github.com/user-attachments/assets/18d21952-5671-4484-afd0-4bf5f1608eee" />

- Jonka jälkeen latasin John the ripperin jumbo version:

<img width="654" height="177" alt="image" src="https://github.com/user-attachments/assets/e9a21267-fbd4-4198-b012-3d1f05d036e3" />

- Seuraavaksi latasin Teron antaman zip esimerkkitiedoston:

<img width="1314" height="196" alt="image" src="https://github.com/user-attachments/assets/e5fbf248-2da3-4895-ae9e-1a2bd049bfb2" />

- Koitin sitten avata sen, mutta en saanut sitä auki ilman salasanaa:

<img width="468" height="126" alt="image" src="https://github.com/user-attachments/assets/c5880248-91f4-476b-b832-d8e2cbcd9978" />

Sitten murtamaan salasanaa. Ensiksi komennolla `zip2john tero.zip >tero.zip.hash`


<img width="1120" height="97" alt="image" src="https://github.com/user-attachments/assets/f9900a25-b3dc-491d-8e48-4f79117fbec8" />

- Ja sitten `john tero.zip.hash`

<img width="822" height="204" alt="image" src="https://github.com/user-attachments/assets/eadaf3de-31ab-4b5d-a2b4-34bf89ac3715" />

- Salasana oli `butterfly`

## e) Tiedosto. Tee itse tai etsi verkosta jokin salakirjoitettu tiedosto, jonka saat auki. Murra sen salaus. (Jokin muu formaatti kuin aiemmissa alakohdissa kokeilemasi).

Tehtävässä käytin avuksi chatgpt:tä salatun pdf:n luomiseen.

Latasin qpdf, jotta voin tehdä pdf-tiedoston, jossa on salaus komennolla `sudo apt install qpdf`

Seuraavaksi loin tyhjän pdf-tiedoston:


<img width="278" height="55" alt="image" src="https://github.com/user-attachments/assets/a666f80e-6b77-47f4-8813-a07702094385" />

Sitten loin pdf-tiedostolle salasanan. Ensimmäinen salasana on user-salasana jota tarvitaan dokumentin avaamiseen, toinen salasana on käyttäjäoikeuksien muokkaamiseen.


<img width="644" height="45" alt="image" src="https://github.com/user-attachments/assets/a9538a21-e6f3-445b-9df7-e37632d3da93" />

Seuraavaksi koitin avata pdf:n, mutta tuli vastaus, että salasana väärin:


<img width="440" height="299" alt="image" src="https://github.com/user-attachments/assets/52f2e65a-c9f1-4b55-b7f7-bce49b9ab1a8" />

Sitten koitin alkaa murtamaan salasanaa:


<img width="555" height="42" alt="image" src="https://github.com/user-attachments/assets/da7cb93c-e232-427f-8f03-fe95e7e696ce" />



<img width="750" height="208" alt="image" src="https://github.com/user-attachments/assets/37c732e3-b071-4746-af3f-928de841bcd4" />

Salasana ei murtunut, koska salasana oli suomenkielinen. Loin uuden pdf-tiedoston samoilla askeleilla, kuin aikaisemmin, mutta tällä kertaa muistan laittaa salasanat enganniksi.

Toisella yrityksellä onnistui:

<img width="757" height="245" alt="image" src="https://github.com/user-attachments/assets/15cff44c-95b2-4c6a-abf3-1eec3d21624a" />

## f) Tiiviste. Tee itse tai etsi verkosta salasanan tiiviste, jonka saat auki. Murra sen salaus. (Jokin muu formaatti kuin aiemmissa alakohdissa kokeilemasi. Voit esim. tehdä käyttäjän Linuxiin ja murtaa sen salasanan.)

Luon sha256 tiivisteellä salasanan, jonka koitan murtaa hashcatilla. Mielenkiintoista nähdä, että kestääkö murtamisessa pidempään, vai onnistuuko se ollenkaan. 

- Ensiksi loin uuden salasanan ja laitoin tiivisteeksi sha256sum


<img width="518" height="62" alt="image" src="https://github.com/user-attachments/assets/a49883c2-b1fb-4483-a643-09b1f9667406" />

Seuraavaksi katsoin, tunnistaako hashcat, mikä tiiviste on kyseessä. Toka arvaus on tässä oikein, joten modeksi pitää laittaa 1400:


<img width="645" height="204" alt="image" src="https://github.com/user-attachments/assets/73d176ae-37e9-45f0-bae8-c297e906e06c" />

Joten, sitten vain murtamaan:


<img width="839" height="53" alt="image" src="https://github.com/user-attachments/assets/52b85aed-a5bf-42bb-8060-5b87ed7e154e" />

Jonka jälkeen menin katsomaan onko listaan ilmestynyt uusi salasana:


<img width="581" height="77" alt="image" src="https://github.com/user-attachments/assets/980f102f-d114-44f5-b90e-6ef693424a77" />



## g) Tee msfvenom-työkalulla haittaohjelma, joka soittaa kotiin (reverse shell). Ota yhteys vastaan metasploitin multi/handler -työkalulla.

Hyökkäyskoneen ip: 192.168.56.101 Uhrikoneen ip: 192.168.56.102

Aivan ensiksi varmistin, että kumpikaan kone ei saa yhteyttä verkkoon. `ping 8.8.8.8` ja vastauksena molemmilla koneilla oli, että "network is unreachable".
Sitten varmistin, että koneet saavat yhteyden toisiinsa. Olin asettanut tehtävässä h1.md Kybertappoketju Metalspoitable-virtuaalikoneesta host-only adapterin Kali-virtuaalikoneeseeni. Koneet olivat yhteydessä toisiinsa, mutta eivät olleet verkossa:


<img width="522" height="161" alt="image" src="https://github.com/user-attachments/assets/9bf307e5-ff01-4bb2-a30b-89843925667f" />

Ensimmäinen yritys ei tuottanut haluttua tulosta:

<img width="729" height="130" alt="image" src="https://github.com/user-attachments/assets/1ee11dc1-9641-40b5-91ef-577ca92e0266" />

Jonka jälkeen `msfconsole`

Ja sitten:

<img width="762" height="495" alt="image" src="https://github.com/user-attachments/assets/093940c5-9b22-4b59-8095-5e82516ddf37" />

Määritin payloadin, rhostin, lhostin, mutta ei toiminut. Tarkemmalla katselulla ja ajattelulla portti on varmaan väärä, koitetaan portilla 80:

<img width="618" height="193" alt="image" src="https://github.com/user-attachments/assets/cb34825e-9e5c-4130-865b-7be2fa2d885f" />

Nyt näyttää paremmalta, sain haittaohjeleman toimimaan. Valitettavasti en löytänyt mistään ohjeita, kuinka siirtää haittaohjelma Metaspoitable-koneelle, vai oliko se siellä. Päivitän tähän, jos saan asian selville.



### Lähteet
- https://terokarvinen.com/tunkeutumistestaus/ Kurssin kotisivu
- https://terokarvinen.com/2022/cracking-passwords-with-hashcat/ Hashcat
- https://terokarvinen.com/2023/crack-file-password-with-john/ John the ripper
- https://learning.oreilly.com/videos/security-penetration-testing/9780134833989/9780134833989-sptt_00_06_00_00/ Art of hacking- videot














